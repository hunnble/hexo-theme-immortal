<% if (theme.mode.layout && theme.mode.layout === 'parallax') { %>
  <% var sidebarClass = 'col m3 push-m1 hide-on-med-and-down sidebar' %>
<% } else { %>
  <% var sidebarClass = 'col m3 push-m1 hide-on-med-and-down sidebar sidebar-default' %>
<% } %>
<aside class="<%= sidebarClass %>">

  <% if (is_post()) { %>
    <div class="toc card-panel <%= background %> <%= color %>-text z-depth-0 collection">
      <i class="material-icons right">subject</i>
      <header class="subheader <%= titleColor %>-text">
        <%= _p('toc_title') %>
      </header>
      <%- toc(page.content, {
        'class': 'table-of-contents collection-item',
        'list_number': false
      }) %>
    </div>
  <% } %>

  <% if (theme.widgits) { %>

    <% if (theme.widgits.category && site.categories.length) { %>
      <section class="card-panel <%= background %> <%= color %>-text z-depth-0">
        <i class="material-icons right">markunread_mailbox</i>
        <header class="subheader <%= titleColor %>-text">
          <%= _p('category_title') %>
        </header>
        <%- list_categories({
          depth: 1
        }) %>
      </section>
    <% } %>

    <% if (theme.widgits.tag && site.tags.length) { %>
      <section class="card-panel <%= background %> <%= color %>-text z-depth-0">
        <i class="material-icons right">label</i>
        <header class="subheader <%= titleColor %>-text">
          <%= _p('tag_title') %>
        </header>
        <% if (theme.widgits.tag === 'cloud') { %>
          <ul>
            <li><%- tagcloud(site.tags, {
              min_font: 12,
              max_font: 28
            }) %></li>
          </ul>
        <% } else { %>
          <%- list_tags({}) %>
        <% } %>
      </section>
    <% } %>

    <% if (theme.widgits.recent_posts && site.posts.length) { %>
      <section class="card-panel <%= background %> <%= color %>-text z-depth-0">
        <i class="material-icons right">input</i>
        <header class="subheader <%= titleColor %>-text">
          <%= _p('recent_title') %>
        </header>
        <%- list_posts({
          amount: theme.recent_count
        }) %>
      </section>
    <% } %>

  <% } %>

</aside>
